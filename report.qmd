---
title: "Project title"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

Introduction and Data

This research topic aims to understand various tech jobs and how they pay on average. Our research question is: How have the salaries of different jobs within the field of tech changed over time? Also, are these results different for companies in the US vs. outside the US?

Our hypothesis is that machine learning/AI salaries will have increased in recent years more so than Data scientist/analyst jobs, and that that US-based workers will have higher mean salaries.

The source of the data is ai-jobs.net. It is a website for posting tech jobs and alayzing trends in job data. The site collects salary information anonymously from professionals all over the world in the AI/ML/Data Science space and makes it publicly available. The vast majority of the data was collected in 2023, 2022, and 2021. Each observation records the person's job info. This includes work year, employment type, job title, salary, employee residence, company location, etc.. We would most likely use the salary_in_usd variable as our response variable, which is quantitative, along with categorical explanatory variables including job_title and employee_residence.

One possible ethical issue regarding how our data was collected is that people submit their own salary information to this dataset. This could lead to people submitting incorrect information and lying about their salaries.

\
Methodology

```{r}
#| label: load-pkgs
#| message: false

library(tidyverse)
library(tidymodels)
```

```{r}
#| label: load-data-1
#| message: false

salaries <- read_csv("data/salaries.csv")

glimpse(salaries)
```

```{r}
#| label: lin-reg

salary_jobs <- salaries |>
  filter(job_title %in% c("Data Scientist", "Data Analyst", "Machine Learning Engineer"))

salary_jobs <- salary_jobs |>
  mutate(work_year = work_year - 2020) |>
  mutate("US_based" = if_else(company_location == "US", "US", "Not US"))
  

linear_reg() |>
  set_engine("lm") |>
  fit(salary_in_usd ~ work_year * job_title, data = salary_jobs) |>
  tidy()
```

```{r}

salary_jobs |>
     ggplot(aes(x = work_year, y = salary_in_usd, color = job_title)) +
     geom_point(alpha = 0.05) +
     labs(
      title = "Average Salary per year by Job Title",
       x = "Year",
       y = "Salary (USD)",
       color = "job_title"
    ) +
    geom_smooth(method = "lm", se = FALSE, linetype = "dashed") + 
    scale_color_discrete(labels = c("Data Analyst", "Data Scientist", "Machine Learning Engineer"))
```

```{r}
boot_df <- salary_jobs |>
  specify(response = salary) |>
  generate(reps = 5000, type = "bootstrap") |>
  calculate(stat = "mean")

boot_df |>
  summarize(lower = quantile(stat, 0.005),
            upper = quantile(stat, 0.995))
```

```{r}
#| label: plot-salaries-by-year

salary_jobs |>
  ggplot(aes(x = work_year, y = salary_in_usd, color = job_title, fill = US_based)) +
  geom_point() +
  facet_wrap("US_based")

```

Result
